<?xml version="1.0"?>
<launch>
        <param name="use_sim_time" value="true" />
        <arg name="mav_name" default="jay" />
        <arg name="bag_file" default="/home/lxy/Datasets/deutsches_museum/deutsche_museum_s4.bag" />
        <arg name="freeture_config_file" default="$(find freeture_matcher)/config/example.yaml" />
        <arg name="output_bag_file" default="/workspaces/voxgraph_melodic_ws/eval/esdf_pointcloud2.bag" />
        <arg name="record" default="false" />

        <!--        <node name="map_to_map_0" pkg="tf" type="static_transform_publisher" output="screen" args="0 0 0 0 0 0 1 /map /map_0" />-->
        <!--  <node name="base_to_horizontal" pkg="tf" type="static_transform_publisher" output="screen" args="0.010 0.000 0.190 0.087 0.000 0.996 -0.000 /base_link /horizontal_vlp16_link" /> -->
        <!--        <node name="base_to_vertical" pkg="tf" type="static_transform_publisher" output="screen" args="0.190 0.000 0.040 0.000 0.643 0.000 0.766 /base_link /vertical_vlp16_link" />-->
        <arg name="launch-prefix" value="gdb -ex run --args" />
        <node name="freeture_matcher_node" pkg="freeture_matcher" type="freeture_matcher_node" output="screen" args="-alsologtostderr" launch-prefix="$(arg launch-prefix)">
                <remap from="~tsdf_map_in" to="/tsdf_client_0/tsdf_map_out" />
                <rosparam file="$(arg freeture_config_file)" />
        </node>

        <group if="$(arg record)">
                <include file="$(find coxgraph)/launch/firefly/tsdf_client.launch">
                        <arg name="id" value="0" />
                        <arg name="verbose" default="false" />
                        <arg name="pointcloud_topic" value="/horizontal_laser_3d" />
                        <arg name="world_frame_suffix" value="map" />
                        <arg name="debug" value="false" />
                        <arg name="tw_voxblox_config_file" value="$(find coxgraph)/config/deutsche_museum/tsdf_server.yaml" />
                </include>

                <node name="recorder" pkg="rosbag" type="record" output="screen" args="-O $(arg output_bag_file)  --node=freeture_matcher_node" />
        </group>

        <group unless="$(arg record)">
                <node name="player" pkg="rosbag" type="play" output="screen" args="$(arg output_bag_file) -q" />
        </group>
</launch>
